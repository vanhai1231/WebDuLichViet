<!-- add-tour-form.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security5"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns="http://www.w3.org/1999/html"
      layout:decorate="~{layout_admin}">
<head>
    <meta charset="UTF-8">
    <title>Add Tour</title>
    <link rel="stylesheet" th:href="@{/assets/css/Admin.css}" type="text/css">
</head>
<body>
<section layout:fragment="content" style="position: relative;">
    <div class="col-md-12 ">
        <h3>Thêm Tour</h3>

        <div class="col-md-9" style="margin-left:150px;">
            <form action="/Admin/AddTour" method="post" th:object="${tour}" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="maTour">Mã Tour:</label>
                    <input type="text" id="maTour" name="maTour" th:field="*{maTour}" required><br><br>
                    <span id="maTourError" class="text-danger"></span>
                </div>
                <script>
                    // Lấy thẻ input và span hiển thị lỗi
                    var maTourInput = document.querySelector('input[name="maTour"]');
                    var maTourError = document.getElementById('maTourError');

                    // Lắng nghe sự kiện khi mất focus khỏi input
                    maTourInput.addEventListener('blur', function () {
                        // Kiểm tra nếu giá trị của input không hợp lệ
                        if (maTourInput.validity.valueMissing) {
                            // Hiển thị thông báo lỗi tùy chỉnh
                            maTourError.textContent = 'Vui lòng mã Tour.';
                        } else {
                            // Nếu hợp lệ, xóa thông báo lỗi
                            maTourError.textContent = '';
                        }
                    });
                </script>

                <div class="form-group">
                    <label for="tenTour">Tên Tour:</label>
                    <input type="text" id="tenTour" name="tenTour" th:field="*{tenTour}" required><br><br>
                    <span id="tenTourError" class="text-danger"></span>
                </div>
                <script>
                    // Lấy thẻ input và span hiển thị lỗi
                    var tenTourInput = document.querySelector('input[name="tenTour"]');
                    var tenTourError = document.getElementById('tenTourError');

                    // Lắng nghe sự kiện khi mất focus khỏi input
                    tenTourInput.addEventListener('blur', function () {
                        // Kiểm tra nếu giá trị của input không hợp lệ
                        if (tenTourInput.validity.valueMissing) {
                            // Hiển thị thông báo lỗi tùy chỉnh
                            tenTourError.textContent = 'Vui lòng nhập tên Tour.';
                        } else {
                            // Nếu hợp lệ, xóa thông báo lỗi
                            tenTourError.textContent = '';
                        }
                    });
                </script>
                <div class="form-group">
                    <label for="ngayKH">Ngày Khởi Hành:</label>
                    <input type="datetime-local" id="ngayKH" name="ngayKH" th:field="*{ngayKH}" required><br><br>
                    <span id="ngayKHError" class="text-danger"></span>
                </div>
                <script>
                    // Lấy thẻ input và span hiển thị lỗi
                    var ngayKHInput = document.querySelector('input[name="ngayKH"]');
                    var ngayKHError = document.getElementById('ngayKHError');

                    // Lắng nghe sự kiện khi mất focus khỏi input
                    ngayKHInput.addEventListener('blur', function () {
                        // Kiểm tra nếu giá trị của input không hợp lệ (nếu dùng datetime-local, không cần kiểm tra valueMissing)
                        if (!ngayKHInput.value) {
                            // Hiển thị thông báo lỗi tùy chỉnh
                            ngayKHError.textContent = 'Vui lòng chọn ngày khởi hành.';
                        } else {
                            // Nếu hợp lệ, xóa thông báo lỗi
                            ngayKHError.textContent = '';
                        }
                    });
                </script>
                <div class="form-group">
                    <label for="noiKhoiHanh">Nơi Khởi Hành:</label>
                    <input type="text" id="noiKhoiHanh" name="noiKhoiHanh" th:field="*{noiKhoiHanh}" required><br><br>
                    <span id="noiKhoiHanhError" class="text-danger"></span>
                </div>
                <script>
                    // Lấy thẻ input và span hiển thị lỗi
                    var noiKhoiHanhInput = document.querySelector('input[name="noiKhoiHanh"]');
                    var noiKhoiHanhError = document.getElementById('noiKhoiHanhError');

                    // Lắng nghe sự kiện khi mất focus khỏi input
                    noiKhoiHanhInput.addEventListener('blur', function () {
                        // Kiểm tra nếu giá trị của input không hợp lệ
                        if (noiKhoiHanhInput.validity.valueMissing) {
                            // Hiển thị thông báo lỗi tùy chỉnh
                            noiKhoiHanhError.textContent = 'Vui lòng nhập nơi khởi hành.';
                        } else {
                            // Nếu hợp lệ, xóa thông báo lỗi
                            noiKhoiHanhError.textContent = '';
                        }
                    });
                </script>
                <div class="form-group">
                    <label for="soluong">Số Lượng:</label>
                    <input type="number" id="soluong" name="soluong" th:field="*{soluong}" required><br><br>
                    <span id="soluongError" class="text-danger"></span>
                </div>


                <div class="form-group">
                    <label for="giaTour">Giá:</label>
                    <input type="number" id="giaTour" name="giaTour" th:field="*{giaTour}" required><br><br>
                    <span id="giaTourError" class="text-danger"></span>
                </div>
                <script>
                    // Lấy thẻ input và span hiển thị lỗi cho Số Lượng
                    var soluongInput = document.getElementById('soluong');
                    var soluongError = document.getElementById('soluongError');

                    // Lắng nghe sự kiện khi mất focus khỏi input Số Lượng
                    soluongInput.addEventListener('blur', function () {
                        // Kiểm tra nếu giá trị của input không hợp lệ (nhỏ hơn hoặc bằng 0)
                        if (soluongInput.value <= 0) {
                            // Hiển thị thông báo lỗi tùy chỉnh

                            soluongError.textContent = 'Số lượng phải lớn hơn 0.';
                        } else {
                            // Nếu hợp lệ, xóa thông báo lỗi
                            soluongError.textContent = '';
                        }

                    });

                    // Lấy thẻ input và span hiển thị lỗi cho Giá
                    var giaTourInput = document.getElementById('giaTour');
                    var giaTourError = document.getElementById('giaTourError');

                    // Lắng nghe sự kiện khi mất focus khỏi input Giá
                    giaTourInput.addEventListener('blur', function () {
                        // Kiểm tra nếu giá trị của input không hợp lệ (nhỏ hơn hoặc bằng 0)
                        if (giaTourInput.value <= 0) {
                            // Hiển thị thông báo lỗi tùy chỉnh
                            giaTourError.textContent = 'Giá tour phải lớn hơn 0.';
                        } else {
                            // Nếu hợp lệ, xóa thông báo lỗi
                            giaTourError.textContent = '';
                        }
                    });
                </script>

                <div class="form-group">
                    <label for="tinh" class="form-label">Tỉnh:</label>
                    <select th:field="*{tinh}" class="form-control" id="tinh" required>
                        <option th:each="tinh : ${tinhs}"
                                th:value="${tinh.maTinh}" th:text="${tinh.tenTinh}"></option>
                    </select>
                    <div class="text-danger" th:if="${#fields.hasErrors('tinh')}" th:errors="*{tinh}"></div>
                </div>
                <div class="form-group">
                    <label for="loaiTour" class="form-label">Loại Tour:</label>
                    <select th:field="*{loaiTour}" class="form-control" id="loaiTour" required>
                        <option th:each="loaiTour : ${loaiTours}"
                                th:value="${loaiTour.maLoaiTour}" th:text="${loaiTour.loaiTour}"></option>
                    </select>
                    <div class="text-danger" th:if="${#fields.hasErrors('loaiTour')}" th:errors="*{loaiTour}"></div>



                    <div class="form-group">
                        <label for="loaiTour" class="form-label">Phòng:</label>
                        <select th:field="*{phong}" class="form-control" id="phong" required>
                            <option th:each="phong : ${phongs}"
                                    th:value="${phong.maPhong}" th:text="${phong.loaiPhong.tenLoai}"></option>
                        </select>
                        <div class="text-danger" th:if="${#fields.hasErrors('phong')}" th:errors="*{phong}"></div>
                    </div>
                    <div class="form-group">
                        <label for="phuongTien" class="form-label">Phương Tiện:</label>
                        <select th:field="*{phuongTien}" class="form-control" id="phuongTien" required>
                            <option th:each="phuongTien : ${phuongTiens}"
                                    th:value="${phuongTien.maPhuongTien}" th:text="${phuongTien.tenPhuongTien}"></option>
                        </select>
                        <div class="text-danger" th:if="${#fields.hasErrors('phuongTien')}" th:errors="*{phuongTien}"></div>
                    </div>

                    <div class="form-group">
                        <label for="mainImageFile">Hình Ảnh 1:</label>
                        <input type="file" id="mainImageFile" name="mainImageFile" accept="image/*" required multiple onchange="previewImage1(event)"><br><br>
                        <img id="preview1" src="#" alt="Preview Image" style="max-width: 200px; max-height: 200px; margin-top: 10px; display: none;">
                        <div id="mainImageFileError" class="text-danger"></div>
                    </div>
                    <script>
                        // Lấy thẻ input và span hiển thị lỗi
                        var mainImageFile = document.querySelector('input[name="mainImageFile"]');
                        var mainImageFileError = document.getElementById('mainImageFileError');

                        // Lắng nghe sự kiện khi mất focus khỏi input
                        mainImageFile.addEventListener('blur', function () {
                            // Kiểm tra nếu giá trị của input không hợp lệ
                            if (mainImageFile.validity.valueMissing) {
                                // Hiển thị thông báo lỗi tùy chỉnh
                                mainImageFileError.textContent = 'Vui lòng chọn hình ảnh 1.';
                            } else {
                                // Nếu hợp lệ, xóa thông báo lỗi
                                mainImageFileError.textContent = '';
                            }
                        });
                    </script>
                    <div class="form-group">
                        <label for="secondaryImageFile">Hình Ảnh 2:</label>
                        <input type="file" id="secondaryImageFile" name="secondaryImageFile" accept="image/*" required multiple onchange="previewImage2(event)"><br><br>
                        <img id="preview2" src="#" alt="Preview Image" style="max-width: 200px; max-height: 200px; margin-top: 10px; display: none;">
                        <div id="secondaryImageFileError" class="text-danger"></div>
                    </div>
                    <script>
                        // Lấy thẻ input và span hiển thị lỗi
                        var secondaryImageFile = document.querySelector('input[name="secondaryImageFile"]');
                        var secondaryImageFileError = document.getElementById('secondaryImageFileError');

                        // Lắng nghe sự kiện khi mất focus khỏi input
                        secondaryImageFile.addEventListener('blur', function () {
                            // Kiểm tra nếu giá trị của input không hợp lệ
                            if (secondaryImageFile.validity.valueMissing) {
                                // Hiển thị thông báo lỗi tùy chỉnh
                                secondaryImageFileError.textContent = 'Vui lòng chọn hình ảnh 2.';
                            } else {
                                // Nếu hợp lệ, xóa thông báo lỗi
                                secondaryImageFileError.textContent = '';
                            }
                        });
                    </script>
                    <script>
                        function previewImage1(event) {
                var reader = new FileReader();
                reader.onload = function() {
                    var preview = document.getElementById('preview1');
                    preview1.src = reader.result;
                    preview1.style.display = 'block'; // Hiển thị hình ảnh đã chọn
                }
                reader.readAsDataURL(event.target.files[0]);
            }
                    </script>
                    <script>
                        function previewImage2(event) {
                var reader = new FileReader();
                reader.onload = function() {
                    var preview2 = document.getElementById('preview2');
                    preview2.src = reader.result;
                    preview2.style.display = 'block'; // Hiển thị hình ảnh đã chọn
                }
                reader.readAsDataURL(event.target.files[0]);
            }

                    </script>

                    <div class="form-group btn" style="margin-top:20px">
                        <input type="submit" class="btn btn-success" value="Add Tour" onclick="validateForm()">
                    </div>
                </div>
            </form>

        </div>
    </div>
    <script>
        function validateForm() {
            var maTourInput = document.querySelector('input[name="maTour"]');
            var maTourError = document.getElementById('maTourError');

            var tenTourInput = document.querySelector('input[name="tenTour"]');
            var tenTourError = document.getElementById('tenTourError');

            var ngayKHInput = document.querySelector('input[name="ngayKH"]');
            var ngayKHError = document.getElementById('ngayKHError');

            var noiKhoiHanhInput = document.querySelector('input[name="noiKhoiHanh"]');
            var noiKhoiHanhError = document.getElementById('noiKhoiHanhError');

            var soluongInput = document.getElementById('soluong');
            var soluongError = document.getElementById('soluongError');

            var giaTourInput = document.getElementById('giaTour');
            var giaTourError = document.getElementById('giaTourError');

            var mainImageFile = document.querySelector('input[name="mainImageFile"]');
            var mainImageFileError = document.getElementById('mainImageFileError');

            var secondaryImageFile = document.querySelector('input[name="secondaryImageFile"]');
            var secondaryImageFileError = document.getElementById('secondaryImageFileError');

            var isValid = true;

            // Kiểm tra Mã Tour
            if (!maTourInput.value.trim()) {
                maTourError.textContent = 'Vui lòng nhập Mã Tour.';
                isValid = false;
            } else {
                maTourError.textContent = '';
            }

            // Kiểm tra Tên Tour
            if (!tenTourInput.value.trim()) {
                tenTourError.textContent = 'Vui lòng nhập Tên Tour.';
                isValid = false;
            } else {
                tenTourError.textContent = '';
            }

            // Kiểm tra Ngày Khởi Hành
            if (!ngayKHInput.value.trim()) {
                ngayKHError.textContent = 'Vui lòng chọn Ngày Khởi Hành.';
                isValid = false;
            } else {
                ngayKHError.textContent = '';
            }

            // Kiểm tra Nơi Khởi Hành
            if (!noiKhoiHanhInput.value.trim()) {
                noiKhoiHanhError.textContent = 'Vui lòng nhập Nơi Khởi Hành.';
                isValid = false;
            } else {
                noiKhoiHanhError.textContent = '';
            }

            // Kiểm tra Số Lượng
            if (soluongInput.value <= 0) {
                soluongError.textContent = 'Số lượng phải lớn hơn 0.';
                isValid = false;
            } else {
                soluongError.textContent = '';
            }

            // Kiểm tra Giá Tour
            if (giaTourInput.value <= 0) {
                giaTourError.textContent = 'Giá tour phải lớn hơn 0.';
                isValid = false;
            } else {
                giaTourError.textContent = '';
            }

            // Kiểm tra Hình Ảnh 1
            if (mainImageFile.validity.valueMissing) {
                mainImageFileError.textContent = 'Vui lòng chọn hình ảnh 1.';
                isValid = false;
            } else {
                mainImageFileError.textContent = '';
            }

            // Kiểm tra Hình Ảnh 2
            if (secondaryImageFile.validity.valueMissing) {
                secondaryImageFileError.textContent = 'Vui lòng chọn hình ảnh 2.';
                isValid = false;
            } else {
                secondaryImageFileError.textContent = '';
            }

            // Nếu form hợp lệ thì submit form
            if (isValid) {
                document.querySelector('form').submit();
            }
        }
    </script>

</section>>
</body>


</html>